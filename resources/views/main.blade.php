<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>Приглашение на юбилей</title>
    <link rel="stylesheet" href="/assets/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700&amp;display=swap">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Kaushan+Script&amp;display=swap">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Bad+Script&amp;display=swap">
    <link rel="stylesheet" href="/assets/css/bickham_script_three.css">
    <link
        rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"
    />
</head>

<body id="page-top" data-bs-spy="scroll" data-bs-target="#mainNav" data-bs-offset="54">
<header class="masthead"
        style="background: url(&quot;/assets/img/46126161-81A7-40ED-8.png&quot;) center / cover repeat;height: 500px;">
    <div class="container">
        <div class="intro-text" style="padding-top: 91px;">
            <div class="intro-heading animate__animated animate__delay-1s animate__slow animate__fadeIn"><span
                    style="text-align: center; color: rgb(0,0,0); font-family: 'Bickham Script Three',Arial,sans-serif; font-weight: 600;">Приглашение на юбилей</span>
            </div>
            <div class="intro-lead-in animate__animated animate__delay-2s animate__slow animate__fadeIn"><span
                    style="color: rgb(0,0,0);">Приглашаю на свое торжество посвященное моему 70-летнему юбилею!</span>
            </div>
            <div class="intro-lead-in animate__animated animate__delay-3s animate__slow animate__fadeIn"><span
                    style="color: rgb(0,0,0);">Буду рад провести этот вечер в близком кругу!</span></div>
        </div>
    </div>
</header>
<section class="bg-light" id="team">
    <div class="container">
        <div class="row justify-content-center align-items-center">
            <div id="player" class=""></div>
            Запустить музыку

        </div>
    </div>
</section>
<section class="bg-light" id="team">
    <div class="container">
        <div class="row justify-content-center align-items-center">
            <div class="col-sm-4">
                <div class="team-member"><img class="rounded-circle mx-auto"
                                              src="/assets/img/team/1464717019_oorzhak-valeriy-okpan-oolovich.jpg"><h4
                        style="padding-bottom: 41px;">Валерий Ооржак Окпан-оолович</h4><h4>Дорогие гости!</h4>
                    <p style="padding-top: 12px;">Спешу пригласить Вас на торжество, посвящённое моему 70-летнему
                        юбилею, которое состоится</p>
                    <p style="font-weight: bold;">23-го февраля 2024 года</p>
                    <p>Этот праздник мне хотелось бы отметить в кругу дорогих мне людей, в атмосфере любви, радости и
                        веселья. И Вы, несомненно, сделаете этот день ярче и прекраснее.<br><br>С нетерпением жду
                        счастливой встречи, Ваших добрых и искренних улыбок, тёплых слов и весёлого настроения.<br><br>Надеюсь,
                        Вы обязательно придёте и сможете превратить мой праздник в самый памятный и радостный день!</p>
                </div>
            </div>
        </div>
    </div>
</section>
<section id="about-1">
    <div class="container">
        <div class="row">
            <div class="col-lg-12 text-center"><h2 class="text-uppercase">Место проведения</h2>
                <h3 class="text-muted section-subheading">___________________________________</h3></div>
        </div>
        <div class="row">
            <div class="col-lg-12">
                <ul class="list-group timeline">
                    <li class="list-group-item">
                        <div class="timeline-panel">
                            <div class="timeline-heading"><h4 class="subheading">Ресторан "Аристократ"</h4></div>
                            <div class="timeline-body"><p class="text-muted"
                                                          style="text-align: center;">Адрес: ул.
                                    Каа-хем, д. 100</p></div>
                            <div class="timeline-body"><h4 class="subheading">- Начало в
                                    17:00 -</h4></div>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</section>
<section id="contact" style="background: rgb(248,249,250);">
    <div class="container">
        <div class="row">
            <div class="col-lg-12 text-center"><h2 class="text-uppercase section-heading" style="color: rgb(0,0,0);">жду
                    вас!</h2>
                <h3 class="text-muted section-subheading ending-message">Ниже Вы сможете принять приглашение, заполнив
                    данные о
                    себе.<br><br>Также, вы можете принять приглашение за несколько человек.
                </h3></div>
        </div>
        <div class="row">
            <div class="col-lg-12" id="contactFormDiv">
                <form id="contactForm" name="contactForm">
                    <div class="row">
                        <div class="col-md-6 col-xl-12 guests">

                        </div>
                        <div class="w-100"></div>
                        <div class="col-lg-12 text-end">
                            <div id="success"></div>
                            <a class="btn btn-primary btn-xl text-uppercase" id="addGuestButton"
                               style="width: 106.078px;height: 71px;text-align: center;font-size: 12px;padding-left: 10px;padding-right: 10px;">
                                Добавить гостя
                            </a>
                        </div>
                        <div class="col-lg-12 text-center" style="padding-top: 20px;">
                            <div id="success-1"></div>
                            <button class="btn btn-primary btn-xl text-uppercase" id="sendGuestsButton"
                                    type="button">Принять
                            </button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</section>
<section id="about">
    <div class="container">
        <div class="row">
            <div class="col-lg-12 text-center"><h2
                    style="font-family: 'Bickham Script Three',Arial,sans-serif; font-weight: 600; font-size: 40px;">
                    Буду рад видеть Вас на празднике!</h2>
                <h3 class="text-muted section-subheading" style="margin-bottom: 15px;">
                    ___________________________________</h3>
                <p>С уважением,<br>Валерий Ооржак Окпан-оолович</p></div>
        </div>
    </div>
</section>
<script
    src="https://code.jquery.com/jquery-3.7.1.min.js"
    integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo="
    crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="/assets/js/playerjs.js"></script>
<script src="/assets/js/script.min.js"></script>
<script type="text/javascript">
    var player = new Playerjs({id:"player",ready:"PlayerReady", file:"/assets/img/music.mp3"});

    function PlayerReady(id){
        console.log("ready")
        $("#play_btn").on("click", function (){
            console.log("play")
            player.api("toggle");
        });
    }



    var lastId = 1;

    function getGuestHtml(lastId) {
        return "<div class=\"form-group mb-3 guest\" id='guest_" + lastId + "'>\n" +
            "                                <small class=\"form-text flex-grow-1 lead\">Гость:</small>" +
            "<small class=\"form-text flex-grow-1 lead warning-small text-warning text_warning_" + lastId + " visually-hidden\"><br>Заполните фамилию и имя!</small>\n" +
            "                                <div style=\"\">\n" +
            "                                    <input class=\"form-control\" type=\"text\" name='name_" + lastId + "' id=\"name_" + lastId + "\"\n" +
            "                                                                   placeholder=\"Фамилия Имя\" required=\"\"\n" +
            "                                                                   style=\"margin-right: 10px;\">\n" +
            "                                    <div class=\"dropdown\" style=\"margin-top: 15px;\">\n" +
            "                                        <button class=\"btn btn-primary dropdown-toggle\" name='dropdown_button_" + lastId + "' aria-expanded=\"false\"\n" +
            "                                                data-bs-toggle=\"dropdown\" type=\"button\" id=\"dropdown_button_" + lastId + "\">Взрослый" +
            "                                        </button>\n" +
            "                                        <input type='text' value='adult' class='visually-hidden hidden_input_guest_type' name='guest_type_" + lastId + "'>\n" +
            "                                        <div class=\"dropdown-menu\"><a class=\"dropdown-item\" id=\"adult_dropdown_clicked_" + lastId + "\">Взрослый</a><a\n" +
            "                                                class=\"dropdown-item\" id=\"child_dropdown_clicked_" + lastId + "\">Ребенок</a></div>\n" +
            "                                    </div>\n" +
            "                       <a class=\"btn btn-primary delete-btn visually-hidden\" style='margin-left: 10px; height: 38px; margin-top: 15px;' id=\"delete_btn_clicked_" + lastId + "\">Убрать</a>\n" +
            "                                </div>\n" +
            "<hr style='color: black'>                            " +
            "</div>"
    }

    $("#addGuestButton").on("click", function () {
        lastId++;
        $(".guests").append(getGuestHtml(lastId));
        if (lastId === 7) {
            $("#addGuestButton").addClass("visually-hidden");
        }
        if (lastId >= 2) {
            $(".delete-btn").removeClass("visually-hidden");
        } else {
            $(".delete-btn").addClass("visually-hidden");
        }
    });

    $(".guests").append(getGuestHtml(lastId))
        .on("click", ".delete-btn", function () {
            let deleted_id = $(this).parent().parent().remove();
            if (lastId >= 2) {
                $(".delete-btn").removeClass("visually-hidden");
            } else {
                $(".delete-btn").addClass("visually-hidden");
            }
        })
        .on("click", ".dropdown-item", function () {
            let full_attrId = $(this).attr("id");
            let guest = full_attrId.slice(0, 5);
            let id = full_attrId.slice(23, 25);
            if (guest === "adult") {
                $(".hidden_input_guest_type").val("adult");
                $("#dropdown_button_" + id).text("Взрослый");
            } else {
                $(".hidden_input_guest_type").val("child");
                $("#dropdown_button_" + id).text("Ребенок");
            }
        });

    $(document).on("click", "#sendGuestsButton", function () {
        let sendData = $(this).parent().parent().parent().serializeArray();
        $.ajax({
            type: "POST",
            url: "{{ env('APP_URL') }}/api/addGuests",
            data: sendData,
            success: function (success) {
                $('#contactFormDiv').addClass("visually-hidden")
                console.log(success)
                if (success.status !== 'success') {
                    $('.ending-message').html("Произошла ошибка!<br>Попробуйте чуть позже.")
                }
                var names = "";
                for (let i = 1; i <= lastId * 2; i++) {

                    if (sendData[i - 1]["value"]) {
                        // console.log(sendData[i-1]["name"].slice(0,4))
                        if (sendData[i - 1]["name"].slice(0, 4) === "name") {
                            names += sendData[i - 1]["value"] + "<br>"
                        }
                    }
                }

                $('.ending-message').html("Приглашения приняты!<br><br><div style=''>" + names + "</div>")
            }
        });
    })

</script>
</body>

</html>
